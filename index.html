<!DOCTYPE html>
<html>
  <head>
    <title>Test Clerk</title>
  </head>
  <body>
    <h1>Login con Clerk</h1>
    <div id="sign-in"></div>
    <br />
    <button id="getTokenBtn" style="display: none">Obtener Token</button>
    <br /><br />
    <h3>Tu Token:</h3>
    <textarea id="token" style="width: 100%; height: 200px"></textarea>

    <script
      async
      crossorigin="anonymous"
      data-clerk-publishable-key="PONTO TU TOKEN AQUI"
      src="https://grateful-ray-23.clerk.accounts.dev/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
      type="text/javascript"
    ></script>

    <script>
      window.addEventListener("load", async function () {
        await Clerk.load();

        if (Clerk.user) {
          document.getElementById("sign-in").innerHTML = `<p>✅ Hola ${
            Clerk.user.firstName || Clerk.user.emailAddresses[0].emailAddress
          }</p>`;
          document.getElementById("getTokenBtn").style.display = "block";
        } else {
          Clerk.mountSignIn(document.getElementById("sign-in"));
        }

        Clerk.addListener(({ user }) => {
          if (user) {
            document.getElementById("sign-in").innerHTML = `<p>✅ Hola ${
              user.firstName || user.emailAddresses[0].emailAddress
            }</p>`;
            document.getElementById("getTokenBtn").style.display = "block";
          }
        });

        document
          .getElementById("getTokenBtn")
          .addEventListener("click", async () => {
            try {
              const token = await Clerk.session.getToken();
              document.getElementById("token").value = token;
              console.log("Token:", token);
              alert(
                "Token copiado al textarea! Úsalo en Postman con: Authorization: Bearer " +
                  token
              );
            } catch (error) {
              console.error("Error:", error);
              alert("Error: " + error.message);
            }
          });
      });
    </script>
  </body>
</html>
